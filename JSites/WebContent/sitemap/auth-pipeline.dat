	<map:pipeline>
	  <!-- ================= -->
      <!-- Simple login page -->
      <!-- ================= -->
      <map:match pattern="login">
        <!-- if we are already logged in, redirect to the protected document -->
        <map:act type="auth-loggedIn">
          <map:parameter name="handler" value="JSitesHandler"/>
        </map:act> 
        <map:generate src="../login.xml"/>
        <map:transform src="../stylesheets/auth/simple-page2html.xsl">
        	<map:parameter name="resource" value="{request-param:resource}"/>
        </map:transform> 
        <map:transform type="encodeURL"/>
        <map:serialize/>
      </map:match>

      <!-- ========================================= -->
      <!-- Form target which performs auth service   -->
      <!-- ========================================= -->
      <map:match pattern="do-login">
        <!-- try to login -->
        <map:act type="auth-login">
          <map:parameter name="handler" value="JSitesHandler"/>
          <map:parameter name="parameter_name" value="{request-param:username}"/>
          <map:parameter name="parameter_password" value="{request-param:password}"/>
          <map:redirect-to uri="{request-param:resource}"/>
        </map:act>
        <!-- something was wrong, try it again -->
        <map:generate type="timeGenerator" />
        <map:serialize/>
        <!--map:redirect-to uri="login"/-->
      </map:match>
      
      <!-- ========================================= -->
      <!-- Logout link which invalidates the session -->
      <!-- ========================================= -->
      <map:match pattern="do-logout">
        <map:act type="auth-protect">
          <map:parameter name="handler" value="JSitesHandler"/> 
          <map:act type="auth-logout"/>
        </map:act>
        <map:redirect-to uri="{request-param:resource}"/>
      </map:match>
      
      <map:match pattern="logout">
        <map:act type="auth-protect">
          <map:parameter name="handler" value="JSitesHandler"/> 
          <map:act type="auth-logout"/>
        </map:act>
        <map:redirect-to uri="{request-param:resource}"/>
      </map:match>
	
	</map:pipeline>