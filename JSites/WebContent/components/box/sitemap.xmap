<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE map:sitemap [
<!ENTITY generalComponentPipeline SYSTEM "../generalComponentPipeline.dat">
]>

<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">
	

	<map:pipelines>
	
		<map:component-configurations>
			<global-variables>
				<component-name>box</component-name>
			</global-variables>
		</map:component-configurations>
	
		
		<map:pipeline internal-only="false">
	            
	            <map:match pattern="edit">
	                <map:act type="request">
	                	<map:parameter name="parameters" value="true"/>
	             		<map:generate type="componentGenerator" src="{request-param:datadir}/data/box{cid}.xml"/>
						
	                    <map:transform src="boxedit.xslt">
	                    	<map:parameter name="cid" value="{request-param:cid}"/>
							<map:parameter name="time" value="{request-param:time}"/>
							<map:parameter name="pid" value="{request-param:pid}"/>
	                    </map:transform>
	                    
	                    <map:transform type="cinclude" />
	                    <map:serialize type="xml"/>
	                </map:act>
	            </map:match>
	            
	            <map:match pattern="save">
					<map:generate type="internalSave"/>
					<map:transform src="boxsave.xslt">
						<!-- map:parameter name="use-request-parameters" value="true"/ -->
					</map:transform>
					<map:transform type="write-source"/>
					<map:transform src="result.xslt">
						<map:parameter name="cid" value="{request-param:cid}"/>
						<map:parameter name="pacid" value="{request-param:pacid}"/>
						<map:parameter name="pid" value="{request-param:pid}"/>
						<map:parameter name="state" value="{request-param:state}"/>
	                </map:transform>
	                <map:transform type="wikitrans"/>
	                <map:transform type="cinclude"/>
					<map:serialize type="xml"/>
				</map:match>

				<map:match pattern="unit">
	                <map:act type="request">
	                	<map:parameter name="parameters" value="true"/>
	             		<map:generate type="componentGenerator" src="{request-param:datadir}/data/box{cid}.xml"/>
						
	                    <map:transform src="unit.xslt">
	                    	<map:parameter name="cid" value="{request-param:cid}" />
							<map:parameter name="unit" value="{request-param:unit}" />
							<map:parameter name="pid" value="{request-param:pid}" />
							<map:parameter name="pacid" value="{request-param:pacid}" />
							<map:parameter name="editing" value="{request-param:editing}" />
							<map:parameter name="lang" value="{request-param:lang}" />
						    <map:parameter name="validating" value="{request-param:validating}" />
						    <map:parameter name="disabling" value="{request-param:disabling}" />
						    <map:parameter name="time" value="{request-param:time}" />
						    <map:parameter name="datadir" value="{request-param:datadir}" />
						    <map:parameter name="quant" value="{request-param:quant}" />
	                    </map:transform>
	                    <map:serialize type="xml"/>
	                </map:act>
	            </map:match>

		</map:pipeline>
		
		&generalComponentPipeline;
		
	</map:pipelines>
	
</map:sitemap>