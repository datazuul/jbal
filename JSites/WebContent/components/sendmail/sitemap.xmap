<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE map:sitemap [
<!ENTITY generalComponentPipeline SYSTEM "../generalComponentPipeline.dat">
]>
<map:sitemap xmlns:map="http://apache.org/cocoon/sitemap/1.0">

	<map:pipelines>
		
		<map:pipeline internal-only="false"> 
	            
	            <map:match pattern="view">
	                <map:act type="request">	                
	                	<map:aggregate element="root">
						  	<map:part src="cocoon:/componentview?re={request-param:datadir}/data/sendmail{request-param:cid}.xml"/>
						  	<map:part src="cocoon:/request"/>
						 </map:aggregate>
	                    
	                    <!-- map:transform type="tutil" src="/t/sendbefore" / -->
	                   
	                    <map:act type="PageCodeAction" src="{global:db}" >
		                    <map:transform src="sendmail.xslt">
		                        <map:parameter name="use-request-parameters" value="true"/>
		                        <map:parameter name="pagecode" value="{request-attr:pagecode}" />
		                        <map:parameter name="pagerequest" value="{request-attr:pagerequest}"/>
		                    </map:transform>
	                    </map:act>
	                    <map:transform type="sendmail">
	                    	<map:parameter name="sendpartial" value="true" />
	                    </map:transform>
	                    
	                    <!-- map:transform type="tutil" src="/t/sendafter0" / -->
	                    
	                    <map:transform src="sendmailresult.xslt" />
	                    
	                    <!-- map:transform type="tutil" src="/t/sendafter1" / -->
	                    
	                    <map:transform type="wikitrans"/>
	                    <map:serialize type="xml"/>
	                </map:act>
	            </map:match>
	            
	            <map:match pattern="componentview">
	                <map:generate type="componentGenerator" src="{request-param:re}" label="edit"/>
	                <map:serialize type="xml"/>
	            </map:match>
	            
	            <map:match pattern="request">
	                <map:generate type="request" label="edit"/>
	                <map:serialize type="xml"/>
	            </map:match>
	            
	            <map:match pattern="edit">
	                <map:act type="request">
	                	<map:parameter name="parameters" value="true"/>
	             		<map:generate type="componentGenerator" src="{request-param:datadir}/data/sendmail{cid}.xml"/>
	
	                    <map:transform src="sendmailedit.xslt">
	                    	<map:parameter name="use-request-parameters" value="true"/>
	                    </map:transform>
	                    
	                    <map:serialize type="xml"/>
	                </map:act>
	            </map:match>
	            
	            <map:match pattern="save">
					<map:generate type="internalSave"/>
					<map:transform src="sendmailsave.xslt">
						<map:parameter name="use-request-parameters" value="true"/>
					</map:transform>

					<map:transform type="write-source"/>
					<map:transform src="saving.xslt">
						<map:parameter name="use-request-parameters" value="true"/>
	                </map:transform>

					<map:serialize type="xml"/>
				</map:match>
				
		</map:pipeline>
		&generalComponentPipeline;
	</map:pipelines>
	
</map:sitemap>